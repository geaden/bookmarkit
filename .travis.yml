language: python

python:
  - "2.7"
  - "2.6"

install: "pip install -r requirements/ci.txt"

script: ./test.sh

env: 
  global:
    - SECRET_KEY="test"
    - RECAPTCHA_PUBLIC_KEY="test"
    - RECAPTCHA_PRIVATE_KEY="test"
    - ADMIN_USER="foo@bar.bz"
    - GOOGLEAPI_CLIENT_ID="apps.googleusercontent.com"
    - GOOGLEAPI_CLIENT_SECRET="test"
    - GOOGLEAPI_REDIRECT_URL="http://localhost:8000/users/oauth2callback"

branches:
  only:
    - ci

# Sauce addon
addons:
  sauce_connect:
    username: "geaden"
    access_key: "202ebc07-f1aa-4a75-888f-580d829a8aa7"

# GUI
before_install:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3 # give xvfb some time to start
  - rackup  # start a Web server
  - sleep 3 # give Web server some time to bind to sockets, etc
